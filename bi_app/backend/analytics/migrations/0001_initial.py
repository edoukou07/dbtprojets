# Generated by Django 5.0 on 2025-11-13 15:39

from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
    ]

    operations = [
        migrations.CreateModel(
            name='MartKPIOperationnels',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('annee', models.IntegerField()),
                ('trimestre', models.IntegerField(blank=True, null=True)),
                ('nom_mois', models.CharField(blank=True, max_length=20, null=True)),
                ('nombre_collectes', models.IntegerField(blank=True, null=True)),
                ('collectes_cloturees', models.IntegerField(blank=True, null=True)),
                ('collectes_ouvertes', models.IntegerField(blank=True, null=True)),
                ('taux_recouvrement_moyen', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('duree_moyenne_collecte_jours', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('taux_cloture_pct', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('taux_recouvrement_global_pct', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('nombre_demandes', models.IntegerField(blank=True, null=True)),
                ('demandes_approuvees', models.IntegerField(blank=True, null=True)),
                ('demandes_rejetees', models.IntegerField(blank=True, null=True)),
                ('demandes_en_attente', models.IntegerField(blank=True, null=True)),
                ('delai_moyen_attribution_jours', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('taux_approbation_pct', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('nombre_factures_emises', models.IntegerField(blank=True, null=True)),
                ('factures_payees', models.IntegerField(blank=True, null=True)),
                ('delai_moyen_paiement_jours', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('montant_total_a_recouvrer', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('montant_total_recouvre', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('montant_total_facture', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('montant_paye', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
            ],
            options={
                'db_table': '"dwh_marts_operationnel"."mart_kpi_operationnels"',
                'ordering': ['-annee', 'trimestre'],
                'get_latest_by': ['-annee', '-trimestre'],
                'managed': False,
            },
        ),
        migrations.CreateModel(
            name='MartOccupationZones',
            fields=[
                ('zone_id', models.IntegerField(primary_key=True, serialize=False)),
                ('nom_zone', models.CharField(max_length=255)),
                ('nombre_total_lots', models.IntegerField(blank=True, null=True)),
                ('lots_disponibles', models.IntegerField(blank=True, null=True)),
                ('lots_attribues', models.IntegerField(blank=True, null=True)),
                ('lots_reserves', models.IntegerField(blank=True, null=True)),
                ('superficie_totale', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True)),
                ('superficie_disponible', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True)),
                ('superficie_attribuee', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True)),
                ('taux_occupation_pct', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('taux_viabilisation_pct', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('valeur_totale_lots', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('valeur_lots_disponibles', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('lots_viabilises', models.IntegerField(blank=True, null=True)),
                ('nombre_demandes_attribution', models.IntegerField(blank=True, null=True)),
                ('demandes_approuvees', models.IntegerField(blank=True, null=True)),
                ('demandes_rejetees', models.IntegerField(blank=True, null=True)),
                ('demandes_en_attente', models.IntegerField(blank=True, null=True)),
                ('delai_moyen_traitement', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('taux_approbation_pct', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
            ],
            options={
                'db_table': '"dwh_marts_occupation"."mart_occupation_zones"',
                'managed': False,
            },
        ),
        migrations.CreateModel(
            name='MartPerformanceFinanciere',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('annee', models.IntegerField()),
                ('mois', models.IntegerField(blank=True, null=True)),
                ('trimestre', models.IntegerField(blank=True, null=True)),
                ('raison_sociale', models.CharField(blank=True, max_length=255, null=True)),
                ('domaine_activite_id', models.IntegerField(blank=True, null=True)),
                ('nom_zone', models.CharField(blank=True, max_length=255, null=True)),
                ('nombre_factures', models.IntegerField(blank=True, null=True)),
                ('montant_total_facture', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('montant_paye', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('montant_impaye', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('delai_moyen_paiement', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('taux_paiement_pct', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('nombre_collectes', models.IntegerField(blank=True, null=True)),
                ('montant_total_a_recouvrer', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('montant_total_recouvre', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('taux_recouvrement_moyen', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
            ],
            options={
                'db_table': '"dwh_marts_financier"."mart_performance_financiere"',
                'ordering': ['-annee', '-mois'],
                'managed': False,
            },
        ),
        migrations.CreateModel(
            name='MartPortefeuilleClients',
            fields=[
                ('entreprise_id', models.IntegerField(primary_key=True, serialize=False)),
                ('raison_sociale', models.CharField(max_length=255)),
                ('forme_juridique', models.CharField(blank=True, max_length=100, null=True)),
                ('registre_commerce', models.CharField(blank=True, max_length=100, null=True)),
                ('telephone', models.CharField(blank=True, max_length=50, null=True)),
                ('email', models.EmailField(blank=True, max_length=254, null=True)),
                ('secteur_activite', models.CharField(blank=True, max_length=255, null=True)),
                ('nombre_factures', models.IntegerField(blank=True, null=True)),
                ('chiffre_affaires_total', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('ca_paye', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('ca_impaye', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('delai_moyen_paiement', models.DurationField(blank=True, null=True)),
                ('nombre_factures_retard', models.IntegerField(blank=True, null=True)),
                ('taux_paiement_pct', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('nombre_demandes', models.IntegerField(blank=True, null=True)),
                ('demandes_approuvees', models.IntegerField(blank=True, null=True)),
                ('superficie_totale_attribuee', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True)),
                ('nombre_lots_attribues', models.IntegerField(blank=True, null=True)),
                ('segment_client', models.CharField(blank=True, max_length=50, null=True)),
                ('niveau_risque', models.CharField(blank=True, max_length=50, null=True)),
            ],
            options={
                'db_table': '"dwh_marts_clients"."mart_portefeuille_clients"',
                'ordering': ['-chiffre_affaires_total'],
                'managed': False,
            },
        ),
        migrations.CreateModel(
            name='AlertThreshold',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('alert_type', models.CharField(max_length=50, unique=True)),
                ('is_active', models.BooleanField(default=True)),
                ('threshold_value', models.DecimalField(decimal_places=2, max_digits=10)),
                ('threshold_operator', models.CharField(choices=[('<', 'Inférieur à'), ('>', 'Supérieur à'), ('<=', 'Inférieur ou égal à'), ('>=', 'Supérieur ou égal à'), ('==', 'Égal à')], default='<', max_length=10)),
                ('check_interval', models.IntegerField(default=60)),
                ('send_email', models.BooleanField(default=False)),
                ('email_recipients', models.TextField(blank=True, help_text="Liste d'emails séparés par des virgules", null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('last_checked', models.DateTimeField(blank=True, null=True)),
            ],
            options={
                'db_table': 'bi_alert_thresholds',
                'ordering': ['alert_type'],
                'managed': True,
            },
        ),
        migrations.CreateModel(
            name='Alert',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('alert_type', models.CharField(choices=[('taux_recouvrement', 'Taux de Recouvrement Critique'), ('facture_impayee', 'Facture Impayée Ancienne'), ('client_inactif', 'Client Inactif'), ('occupation_faible', "Taux d'Occupation Faible"), ('objectif_non_atteint', 'Objectif Non Atteint')], max_length=50)),
                ('severity', models.CharField(choices=[('low', 'Faible'), ('medium', 'Moyen'), ('high', 'Élevé'), ('critical', 'Critique')], default='medium', max_length=20)),
                ('status', models.CharField(choices=[('active', 'Active'), ('acknowledged', 'Acquittée'), ('resolved', 'Résolue'), ('dismissed', 'Ignorée')], default='active', max_length=20)),
                ('title', models.CharField(max_length=255)),
                ('message', models.TextField()),
                ('context_data', models.JSONField(blank=True, null=True)),
                ('threshold_value', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('actual_value', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('acknowledged_at', models.DateTimeField(blank=True, null=True)),
                ('resolved_at', models.DateTimeField(blank=True, null=True)),
                ('acknowledged_by', models.CharField(blank=True, max_length=100, null=True)),
            ],
            options={
                'db_table': 'bi_alerts',
                'ordering': ['-created_at'],
                'managed': True,
                'indexes': [models.Index(fields=['status', 'severity'], name='bi_alerts_status_ec558e_idx'), models.Index(fields=['alert_type'], name='bi_alerts_alert_t_ace70e_idx'), models.Index(fields=['created_at'], name='bi_alerts_created_f2aa78_idx')],
            },
        ),
    ]
